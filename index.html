<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–£–ü–ò–ò–† - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–æ–≤ –∏ —á–∞—Ç–∞">
    <meta name="theme-color" content="#6366f1">
    <title>–£–ü–ò–ò–† - –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ –∏ —á–∞—Ç</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <script>
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="authScreen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login">–í—Ö–æ–¥</button>
                <button class="tab-btn" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div id="loginForm" class="auth-form active">
                <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                <form id="loginFormElement">
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
                </form>
            </div>

            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="registerForm" class="auth-form">
                <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <form id="registerFormElement">
                    <div class="form-group">
                        <label for="registerName">–ò–º—è</label>
                        <input type="text" id="registerName" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="registerPasswordConfirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="registerPasswordConfirm" required>
                    </div>
                    <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                </form>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="appScreen" class="app-screen hidden">
        <header class="app-header">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">‚ò∞</button>
            <div class="header-left">
                <h1 class="app-logo">‚ú® –£–ü–ò–ò–†</h1>
            </div>
            <div class="header-center">
                <div class="search-box">
                    <input type="text" id="searchUsers" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="currentUserName"></span>
                    <button id="profileBtn" class="btn btn-icon" title="–ü—Ä–æ—Ñ–∏–ª—å">üë§</button>
                    <button id="adminPanelBtn" class="btn btn-icon" title="–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å" style="display: none;">‚öôÔ∏è</button>
                    <button id="logoutBtn" class="btn btn-secondary">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </header>

        <div class="app-container">
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ -->
            <aside class="contacts-panel">
                <div class="contacts-header">
                    <h2>–ß–∞—Ç—ã</h2>
                    <button id="createGroupBtn" class="btn btn-icon-small" title="–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É">‚ûï</button>
                </div>
                <div class="contacts-tabs">
                    <button class="contacts-tab active" data-tab="all">–í—Å–µ</button>
                    <button class="contacts-tab" data-tab="contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
                    <button class="contacts-tab" data-tab="groups">–ì—Ä—É–ø–ø—ã</button>
                </div>
                <div class="contacts-list" id="contactsList">
                    <!-- –ö–æ–Ω—Ç–∞–∫—Ç—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </aside>

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
            <main class="chat-area">
                <div id="noChatSelected" class="no-chat-selected">
                    <div class="welcome-message">
                        <h2>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</h2>
                        <p>–ù–∞—á–Ω–∏—Ç–µ —á–∞—Ç –∏–ª–∏ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫ —Å –ª—é–±—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</p>
                    </div>
                </div>

                <!-- –û–±–ª–∞—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —á–∞—Ç–∞ -->
                <div id="activeChat" class="active-chat hidden">
                    <div class="chat-header">
                        <div class="chat-user-info">
                            <div class="user-avatar" id="chatUserAvatar"></div>
                            <div>
                                <h3 id="chatUserName"></h3>
                                <span class="user-status" id="chatUserStatus">–≤ —Å–µ—Ç–∏</span>
                                <span class="group-members-count" id="groupMembersCount" style="display: none;"></span>
                            </div>
                        </div>
                        <div class="chat-actions">
                            <button id="groupInfoBtn" class="btn btn-icon" title="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–µ" style="display: none;">
                                ‚ÑπÔ∏è
                            </button>
                            <button id="videoCallBtn" class="btn btn-icon" title="–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫">
                                üìπ
                            </button>
                            <button id="audioCallBtn" class="btn btn-icon" title="–ê—É–¥–∏–æ–∑–≤–æ–Ω–æ–∫">
                                üìû
                            </button>
                        </div>
                    </div>

                    <div class="messages-container" id="messagesContainer">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>

                    <div class="message-input-area">
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                        <button id="sendMessageBtn" class="btn btn-primary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
    <div id="profileModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h2>
                <button class="modal-close" id="closeProfileModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ê–≤–∞—Ç–∞—Ä</label>
                    <div class="avatar-edit-container">
                        <div class="user-avatar-large" id="profileAvatarPreview"></div>
                        <input type="text" id="profileAvatarInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞" maxlength="1">
                    </div>
                </div>
                <div class="form-group">
                    <label for="profileName">–ò–º—è</label>
                    <input type="text" id="profileName" required>
                </div>
                <div class="form-group">
                    <label for="profileEmail">Email</label>
                    <input type="email" id="profileEmail" required>
                </div>
                <div class="form-group">
                    <label for="profileCurrentPassword">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å (–¥–ª—è —Å–º–µ–Ω—ã)</label>
                    <input type="password" id="profileCurrentPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ –º–µ–Ω—è–µ—Ç–µ">
                </div>
                <div class="form-group">
                    <label for="profileNewPassword">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="profileNewPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ –º–µ–Ω—è–µ—Ç–µ" minlength="6">
                </div>
                <div class="form-group">
                    <label for="profileConfirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="profileConfirmPassword" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ –º–µ–Ω—è–µ—Ç–µ">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelProfile" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                <button id="saveProfile" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ -->
    <div id="adminModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
                <button class="modal-close" id="closeAdminModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</label>
                    <div class="admin-users-list" id="adminUsersList">
                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–≤–µ—â–∞–Ω–∏—è -->
    <div id="meetingModal" class="meeting-modal hidden">
        <div class="meeting-content">
            <h1 class="meeting-text">–°–û–í–ï–©–ê–ù–ò–Ø</h1>
            <button id="closeMeetingBtn" class="btn btn-danger">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã -->
    <div id="createGroupModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</h2>
                <button class="modal-close" id="closeCreateGroupModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="groupName">–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã</label>
                    <input type="text" id="groupName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã" required>
                </div>
                <div class="form-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</label>
                    <div class="participants-list" id="participantsList">
                        <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelCreateGroup" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                <button id="createGroup" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≥—Ä—É–ø–ø–µ -->
    <div id="groupInfoModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="groupInfoTitle">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–µ</h2>
                <button class="modal-close" id="closeGroupInfoModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="group-info-section">
                    <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏</h3>
                    <div class="group-members-list" id="groupMembersList">
                        <!-- –£—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø—ã -->
                    </div>
                </div>
                <div class="group-info-section">
                    <button id="addMemberBtn" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∞</button>
                    <button id="leaveGroupBtn" class="btn btn-danger">–ü–æ–∫–∏–Ω—É—Ç—å –≥—Ä—É–ø–ø—É</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∞ -->
    <div id="callModal" class="call-modal hidden">
        <div class="call-container">
            <div class="call-header">
                <h3 id="callUserName">–ó–≤–æ–Ω–æ–∫...</h3>
                <button id="endCallBtn" class="btn btn-danger">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
            </div>
            <div class="video-container">
                <video id="remoteVideo" autoplay playsinline style="display: none;"></video>
                <div id="remoteVideosContainer" class="remote-videos-container">
                    <!-- –í–∏–¥–µ–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                <div class="call-animation" id="callAnimation">
                    <div class="call-animation-content">
                        <div class="call-avatar-large" id="callAvatarLarge"></div>
                        <div class="call-ripple"></div>
                        <div class="call-ripple"></div>
                        <div class="call-ripple"></div>
                        <h3 class="call-animation-name" id="callAnimationName">–ó–≤–æ–Ω–æ–∫...</h3>
                        <p class="call-animation-status" id="callAnimationStatus">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</p>
                    </div>
                </div>
                <video id="localVideo" autoplay muted playsinline></video>
            </div>
            <div class="call-controls">
                <button id="toggleVideoBtn" class="btn btn-icon-large">üìπ</button>
                <button id="toggleAudioBtn" class="btn btn-icon-large">üé§</button>
                <button id="endCallBtnBottom" class="btn btn-danger-large">üìû</button>
            </div>
            <div class="call-status" id="callStatus">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>

